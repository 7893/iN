# ğŸ“¦ iN é¡¹ç›®åŸºç¡€è®¾æ–½èµ„æºè¯¦è§£ï¼ˆ20250420ï¼‰

> æœ¬æ–‡æ¡£è¯¦ç»†è®°å½• iN é¡¹ç›®ä½¿ç”¨çš„å…¨éƒ¨åŸºç¡€è®¾æ–½èµ„æºï¼Œè¦†ç›– Cloudflareã€Firebaseã€Vercel ä¸‰ä¸ªå¹³å°ã€‚

---

## â˜ï¸ Cloudflare èµ„æºæ¸…å•ï¼ˆä¸»æ§ç³»ç»Ÿï¼‰

| ç±»å‹ | åç§°ç¤ºä¾‹ | è¯´æ˜ |
|------|-----------|------|
| Workers | `in-worker-a-api-gateway-20250402` ç­‰ 11 ä¸ª | æ‰€æœ‰ APIã€ä»»åŠ¡å¤„ç†é€»è¾‘è¿è¡Œåœ¨ Worker ä¸­ï¼ŒæŒ‰æ¨¡å—ç‹¬ç«‹éƒ¨ç½² |
| Durable Object | `in-do-a-task-coordinator-20250402` | ä»»åŠ¡çŠ¶æ€åè°ƒå™¨ï¼Œç®¡ç†ä»»åŠ¡çŠ¶æ€ç”Ÿå‘½å‘¨æœŸ |
| Queues | `in-queue-a-image-download-20250402` ç­‰ 7 ä¸ª | å¼‚æ­¥ä»»åŠ¡ä¸»é“¾ä¸å‰¯ä½œç”¨äº‹ä»¶é“¾ |
| R2 Bucket | `in-r2-a-image-bucket-20250402` | å›¾åƒåŸå›¾ä¸ä¸­é—´ç»“æœæ–‡ä»¶å­˜å‚¨ |
| D1 æ•°æ®åº“ | `in-d1-a-database-20250402` | ç»“æ„åŒ–å…ƒæ•°æ®ã€ä»»åŠ¡è®°å½•ã€ç”¨æˆ·é…ç½® |
| KV å‘½åç©ºé—´ | `in-kv-a-runtime-config-20250402` | é…ç½®ç¼“å­˜ / å¿«é€Ÿç´¢å¼•è¡¨ç­‰å°å‹æ•°æ®å­˜å‚¨ |
| Vectorize Index | `in-vectorize-a-index-20250402` | å›¾åƒå‘é‡åµŒå…¥ä¸ç›¸ä¼¼å›¾æŸ¥è¯¢æ”¯æŒ |
| Secrets Store | å„ Worker ç»‘å®šä¸“å±å¯†é’¥ | åŒ…å« `RUNTIME_HMAC_SECRET`ã€AI å¯†é’¥ç­‰è¿è¡Œæ—¶å¯†é’¥ |
| Logpush | `in-logpush-a-axiom-20250402` | æ¨é€ç»“æ„åŒ–æ—¥å¿—è‡³ Axiom ç”¨äºè§‚æµ‹ä¸å‘Šè­¦ |

---

## ğŸ” Firebase èµ„æºæ¸…å•ï¼ˆè¾…åŠ©ç”¨æˆ·èº«ä»½ä¸é…ç½®ï¼‰

| ç±»å‹ | åç§° | è¯´æ˜ |
|------|------|------|
| é¡¹ç›® ID | `in-fb-core-20250420` | Firebase ä¸»é¡¹ç›®æ ‡è¯†ï¼Œä¸ Vercel / API ç»‘å®šé…åˆ |
| Auth | Gmail / GitHub ç™»å½•å¯ç”¨ | ç”¨äºç”¨æˆ· OAuth ç™»å½•ä¸ token è·å– |
| Firestore | `presets` / `favorites` é›†åˆ | ç”¨æˆ·é…ç½®å­˜å‚¨ï¼ˆåå¥½ã€æ”¶è—å¤¹ã€ä¸‹è½½é¢„è®¾ç­‰ï¼‰ |
| API å¯†é’¥ | ç¯å¢ƒå˜é‡ä¸­ç®¡ç† | Firebase SDK ä½¿ç”¨çš„å¯†é’¥ï¼Œä»…åœ¨åç«¯ä½¿ç”¨ |
| Firebase æ§åˆ¶å° | https://console.firebase.google.com/project/in-fb-core-20250420 | æ§åˆ¶å°ç®¡ç†è®¤è¯ä¸è§„åˆ™è®¾ç½®ç­‰ |

---

## ğŸ¨ Vercel èµ„æºæ¸…å•ï¼ˆå‰ç«¯å±•ç¤ºå¹³å°ï¼‰

| ç±»å‹ | åç§° | è¯´æ˜ |
|------|------|------|
| é¡¹ç›®åç§° | `in-vc-pages-20250420` | å‰ç«¯æ‰˜ç®¡é¡¹ç›®ï¼ŒSvelteKit æ¸²æŸ“ç”¨æˆ·ç•Œé¢ |
| Team | é»˜è®¤æˆ–ä¸ªäºº Team | ç”¨äºé›†æˆ GitLab ä»“åº“å¹¶éƒ¨ç½² Preview |
| ç¯å¢ƒå˜é‡ | ä¸ GitLab åŒæ­¥ç®¡ç† | åŒ…å« `API_GATEWAY_URL`, `FIREBASE_CONFIG`, `PUBLIC_SITE_ID` ç­‰ |
| éƒ¨ç½²åˆ†æ”¯ | `main`, `preview/*` | Vercel è‡ªåŠ¨éƒ¨ç½²åˆ†æ”¯ï¼ˆä¸ GitHub Actions æˆ– GitLab é…åˆï¼‰ |
| SSR æ”¯æŒ | å¯ç”¨ Vercel Edge Functionsï¼ˆå¯é€‰ï¼‰ | å½“å‰é‡‡ç”¨ SSG / ISR + API æ¥å£ç»“åˆ |
| Preview é“¾æ¥ | `*.vercel.app` | å„åˆ†æ”¯ç”Ÿæˆçš„é¢„è§ˆåœ°å€ï¼Œç”¨äºæµ‹è¯•ä¸è¿­ä»£å±•ç¤º |

---

## ğŸ“š ç®¡ç†æ–¹å¼

- æ‰€æœ‰ Cloudflare èµ„æºç”± Terraform ç®¡ç†ï¼ˆä½äº `infra/`ï¼‰
- Firebase é¡¹ç›®æ‰‹åŠ¨åˆå§‹åŒ–ï¼Œé…ç½®ä¿¡æ¯è®°å½•åœ¨ `.env.secrets`
- Vercel é¡¹ç›®é€šè¿‡æ§åˆ¶å°ä¸ GitLab ä»“åº“ç»‘å®šï¼Œé…ç½®ç”± `project-settings` ä¸ `wrangler.toml` ååŒç»´æŠ¤

---

## ğŸ”’ å®‰å…¨è¯´æ˜

- æ‰€æœ‰å¯†é’¥å‡å­˜æ”¾äº `.env.secrets` å¹¶é€šè¿‡ä»¥ä¸‹è„šæœ¬åŒæ­¥ï¼š
  - `tools/sync-runtime-to-cloudflare.sh`
  - `tools/sync-to-gitlab.sh`
- Firebase API Key ä»…ä¾›åç«¯è°ƒç”¨ï¼Œå‰ç«¯ä½¿ç”¨çš„å…¬å¼€é…ç½®é€šè¿‡ ENV æ³¨å…¥æ§åˆ¶æš´éœ²
- æ—¥å¿—ä¸è®¤è¯ä¿¡æ¯ä½¿ç”¨ `traceId`, `taskId`, `userId` ä¸¥æ ¼ç»“æ„åŒ–è®°å½•

---

