# å†™å…¥æ¶æ„æ¦‚è¦åˆ° markdown æ–‡ä»¶
from pathlib import Path

md_content = """
# iN é¡¹ç›®æ¶æ„æ¦‚è¦

> æ—¶é—´ï¼š2025å¹´4æœˆ10æ—¥  
> åœ°ç‚¹ï¼šéŸ©å›½ é¦–å°”ï¼ˆKSTï¼‰

---

## 1. é¡¹ç›®ç›®æ ‡ä¸åŸåˆ™

- **ç›®æ ‡ï¼š** æ„å»ºä¸€ä¸ªåŸºäº Cloudflare çš„ã€åˆ†å¸ƒå¼çš„å›¾ç‰‡è‡ªåŠ¨åŒ–å¤„ç†ç³»ç»Ÿï¼Œæ¶µç›–è·å–ã€å¤„ç†ã€å­˜å‚¨ã€æœç´¢ä¸åˆ†ç±»åŠŸèƒ½ã€‚
- **æ ¸å¿ƒåŸåˆ™ï¼š**
  - å¼‚æ­¥ã€äº‹ä»¶é©±åŠ¨ã€æ¨¡å—åŒ–ã€å¯æ‰©å±•
  - å®‰å…¨æ€§ã€é«˜å¯è§‚æµ‹æ€§ã€æ€§èƒ½ä¸æˆæœ¬ä¼˜åŒ–
  - æ·±åº¦ä½¿ç”¨ Cloudflare Native æœåŠ¡
  - åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆIaCï¼‰å…¨é¢è½åœ°

---

## 2. æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **è®¡ç®—ï¼š** Cloudflare Workersï¼ˆä¼˜å…ˆ Standardï¼Œå¿…è¦æ—¶ä½¿ç”¨ Unboundï¼‰
- **æ¶ˆæ¯é˜Ÿåˆ—ï¼š** Cloudflare Queues + DLQ
- **çŠ¶æ€åè°ƒï¼š** Durable Objectsï¼ˆæŒ‰ taskId åˆ†ç‰‡ï¼‰
- **å­˜å‚¨ï¼š** R2ï¼ˆå¯¹è±¡ï¼‰ï¼ŒD1ï¼ˆç»“æ„åŒ–ï¼‰ï¼ŒVectorizeï¼ˆå‘é‡ï¼‰
- **å‰ç«¯éƒ¨ç½²ï¼š** Cloudflare Pages
- **æ—¥å¿—ï¼š** Logpush â†’ Axiom / Logtail / Sentry ç­‰
- **AI èƒ½åŠ›ï¼š** Cloudflare AIï¼ˆä¸ºä¸»ï¼‰æˆ–å¤–éƒ¨ AIï¼ˆè¡¥å……ï¼‰

---

## 3. å¼€å‘ä¸ç®¡ç†æ–¹å¼

- **ä»£ç ç®¡ç†ï¼š** Monorepoï¼ˆpnpm / Turborepoï¼‰
- **åŸºç¡€è®¾æ–½ç®¡ç†ï¼š** Terraform ç®¡ç†æ‰€æœ‰èµ„æº
- **å¯†é’¥ç®¡ç†ï¼š** Cloudflare Secrets Store

---

## 4. æ¶æ„é£æ ¼ä¸é€šä¿¡æ¨¡å‹

- **åˆ†å±‚ç»“æ„ï¼š** ç½‘å…³å±‚ / API å±‚ / æ•°æ®å¤„ç†å±‚ / åè°ƒå±‚ / å­˜å‚¨å±‚
- **æ¨¡å—åŒ–åŸåˆ™ï¼š** Worker èŒè´£å•ä¸€ã€é€»è¾‘è½»é‡
- **é€šä¿¡æ¨¡å‹ï¼ˆæ··åˆå¼ Pub/Subï¼‰ï¼š**
  - **æ ¸å¿ƒæµç¨‹ï¼š** ç”¨ä»»åŠ¡é˜Ÿåˆ—é©±åŠ¨ï¼ˆDownload â†’ Metadata â†’ AIï¼‰
  - **å¹¿æ’­æ‰©å±•ï¼š** ç”¨äº‹ä»¶é˜Ÿåˆ—å¹¿æ’­å…³é”®äº‹ä»¶ï¼ˆå¦‚ image.downloadedï¼‰

---

## 5. å…³é”®ç»„ä»¶è¯´æ˜

- **API Gateway Workerï¼š** è·¯ç”±ã€JWT/HMAC éªŒè¯ã€traceId æ³¨å…¥
- **API Workersï¼š** å•ä¸€èŒè´£ï¼Œå¤„ç†æŸ¥è¯¢ / é…ç½® / ç”¨æˆ·æ¥å£
- **Data Workersï¼š** Downloadã€Metadataã€AI ç­‰å“åº”é˜Ÿåˆ—æ‰§è¡Œä»»åŠ¡
- **Config Workerï¼š** ç”Ÿæˆä»»åŠ¡ï¼ŒæŠ•é€’åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œé…ç½®è°ƒåº¦
- **Task Coordinator DOï¼š** æŒ‰ taskId ç®¡ç†ä»»åŠ¡çŠ¶æ€æµè½¬
- **Queuesï¼š** TaskQueue + EventQueueï¼ˆå« DLQï¼‰
- **Pluginsï¼š** æ’ä»¶ç³»ç»Ÿï¼ˆæº/å­˜å‚¨/AIï¼‰é¢„ç•™

---

## 6. å›¾ç‰‡å¤„ç†ç­–ç•¥

- æ ¸å¿ƒæµç¨‹ä¸åšå›¾ç‰‡å˜æ¢ï¼ˆé¿å…æ€§èƒ½ç“¶é¢ˆï¼‰
- å¤–åŒ…æ–¹æ¡ˆï¼š
  - ä¼˜å…ˆï¼šå¤–éƒ¨ Edge Functionï¼ˆå¦‚ Supabaseï¼‰
  - å¯é€‰ï¼šä¸“ç”¨ Workerï¼ˆä½¿ç”¨ Workers Unboundï¼‰

---

## 7. å¯è§‚æµ‹æ€§

- **è¿½è¸ªï¼š** traceId è´¯ç©¿è¯·æ±‚ + é˜Ÿåˆ— + æ—¥å¿—
- **æ—¥å¿—ï¼š** ç»“æ„åŒ– JSON æ—¥å¿—ï¼ˆåŒ…å« traceId, taskId, eventType ç­‰ï¼‰
- **æ—¥å¿—æ”¶é›†ï¼š** Cloudflare Logpush + ç¬¬ä¸‰æ–¹å¹³å°
- **åˆ†æèƒ½åŠ›ï¼š** traceId å®ç°å…¨é“¾è·¯è¿½è¸ªã€é”™è¯¯åˆ†æã€æ€§èƒ½ç“¶é¢ˆæ’æŸ¥

---

## 8. å®‰å…¨æ€§è®¾è®¡

- **ç”¨æˆ·è®¤è¯ï¼š** JWT
- **ç»„ä»¶é—´è®¤è¯ï¼š** HMAC ç­¾åæœºåˆ¶
- **Secrets ç®¡ç†ï¼š** Cloudflare Secrets Store
- **èµ„æºä¿æŠ¤ï¼š** æš‚ä¸ä½¿ç”¨ Zero Trustï¼Œä¾èµ– IP é™åˆ¶ / ç™»å½•ä¿æŠ¤ / VPN

---

## 9. æµ‹è¯•ç­–ç•¥

- å•æµ‹ï¼šVitest / Jest
- é›†æˆæµ‹è¯•ï¼šMockQueue + å¤šæ¨¡å—é“¾è·¯
- E2E æµ‹è¯•ï¼šPlaywright / Cypress

---

## 10. æˆæœ¬æ§åˆ¶ç­–ç•¥

- é¿å…ä¸å¿…è¦çš„ Unbound Worker ä½¿ç”¨
- ä»»åŠ¡å¤„ç†æ—¶é—´å°½é‡çŸ­ï¼ˆé™ä½ DO æ´»è·ƒæ—¶é•¿ï¼‰
- æ¥å—ä»˜è´¹ï¼Œè¿½æ±‚é«˜æ€§ä»·æ¯”è¿è¡Œ
- é‡ç‚¹å…³æ³¨ Durable Object + R2 å­˜å‚¨æˆæœ¬

---

## 11. æ¼”è¿›ç­–ç•¥

- ä»æœ€å°å¯ç”¨ç³»ç»Ÿ (MVP) å‡ºå‘
- æŒç»­æ·»åŠ æ’ä»¶æ”¯æŒã€æ—¥å¿—ç³»ç»Ÿã€è°ƒè¯•å·¥å…·
- æ”¯æŒç°åº¦å‘å¸ƒã€ç®¡ç†åå°ã€æƒé™æ§åˆ¶ã€è®¡è´¹ç³»ç»Ÿç­‰ä¸­é•¿æœŸèƒ½åŠ›æ¼”è¿›

---

> ğŸ“˜ æœ¬æ–‡ä½œä¸º `/docs/architecture/overview.md` ä½¿ç”¨ï¼Œå»ºè®®ä½œä¸º iN æ–‡æ¡£ç³»ç»Ÿçš„é¦–ç« é˜…è¯»å…¥å£ã€‚
"""

path = Path("/mnt/data/overview.md")
path.write_text(md_content.strip(), encoding="utf-8")
path
