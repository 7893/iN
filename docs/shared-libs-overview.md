# iN é¡¹ç›®å…±äº«åº“ä¸æŠ½è±¡å±‚è¯´æ˜  
> æ›´æ–°æ—¶é—´ï¼š2025â€‘04â€‘18Â 13:55Â KST

## æ¦‚è§ˆ  

æœ¬æ–‡æ±‡æ€»äº† **iN é¡¹ç›®** ä¸­è¢«æŠ½è±¡ä¸ºå…±äº«åº“ï¼Œæˆ–ç‹¬ç«‹äºå•ä¸ª Worker çš„æ ¸å¿ƒæ¨¡å—ã€‚  
ç›®æ ‡ï¼šæé«˜æ¨¡å—åŒ–ã€å¯ç»´æŠ¤æ€§ï¼Œè·µè¡Œå…³æ³¨ç‚¹åˆ†ç¦»ä¸å‡½æ•°å¼ç¼–ç¨‹ç­‰ç°ä»£å·¥ç¨‹èŒƒå¼ã€‚

---

## âœ… å…±äº«åº“ï¼ˆ`packages/sharedâ€‘libs/`ï¼‰

| # | æ¨¡å— | ä½œç”¨ | å…¸å‹ç‰¹æ€§ | è¢«è°ä½¿ç”¨ |
|---|------|------|----------|----------|
| 1 | **`logger.ts`** | ç»Ÿä¸€ç»“æ„åŒ–æ—¥å¿— | æ³¨å…¥ `traceId / taskId / workerName`ï¼›æ”¯æŒ `debug/info/warn/error`ï¼›é»˜è®¤ `console` è¾“å‡ºï¼Œä¾¿äº Logpush | æ‰€æœ‰ Worker |
| 2 | **`trace.ts`** | TraceÂ ID ç®¡ç† | ç”ŸæˆÂ UUID/nanoidï¼›ä» Header / Queue æ¶ˆæ¯æå–ï¼›ä¸Šä¸‹æ–‡å®‰å…¨ä¼ æ’­ | æ‰€æœ‰ API & ä»»åŠ¡ Worker |
| 3 | **`auth.ts`** | è®¤è¯/é‰´æƒ | JWTÂ æ ¡éªŒã€HMACÂ ç­¾åã€äº§å‡º `INUserContext` | å…¨éƒ¨ API Workerï¼ˆç» APIÂ Gatewayï¼‰ |
| 4 | **`task.ts`** | DO ä»»åŠ¡çŠ¶æ€å°è£… | `setState()/getState()`ï¼›å¯é€‰çŠ¶æ€æœºæ ¡éªŒï¼›å†…ç½® TraceÂ æ—¥å¿— | config / download / metadata / ai Worker |
| 5 | **`events/`** | äº‹ä»¶æ¨¡å‹ | å®šä¹‰ `INEvent<T>`ã€é›†ä¸­ `event-types.ts` | æœªæ¥ Pub/Subã€æ—¥å¿—ä¸€è‡´åŒ– |
| 6 | **`shared-utils/`** (å¯é€‰) | é€šç”¨å·¥å…· | æ—¶é—´æ ¼å¼åŒ–ã€`generateTaskId()`ã€é‡è¯•é€»è¾‘ã€ç¯å¢ƒå˜é‡åŠ è½½ç­‰ | å¤šä¸ª Worker / è„šæœ¬ |

---

## âœ… é Worker è¿è¡Œæ—¶æ¨¡å—

| ä¸»é¢˜ | å·¥å…· / æ–‡ä»¶ | è¯´æ˜ |
|------|------------|------|
| Secrets ç®¡ç† | **CloudflareÂ SecretsÂ Store** | ç»Ÿä¸€å¯†é’¥åˆ†å‘ï¼›æœ¬åœ° `.env`ã€`terraform.tfvars`ã€CI/CD å˜é‡ä¸‰æ–¹åŒæ­¥ |
| è¯·æ±‚æ ¡éªŒ | `request-schema.ts` (Zod / Valibot) | API å…¥å‚æ¨¡å¼éªŒè¯ï¼Œé˜²å¾¡æ€§ç¼–ç¨‹ |
| æµ‹è¯•å·¥å…· | `test-utils.ts` | MockÂ ç”Ÿæˆã€QueueÂ æ¶ˆæ¯æ¨¡æ‹Ÿï¼ŒæœåŠ¡äºÂ Vitest/Jest |

---

## ğŸ§© æ±‡æ€»è¡¨

| ç±»åˆ« | è·¯å¾„ / åç§° | ä½œç”¨æè¿° |
|------|-------------|----------|
| Logging | `sharedâ€‘libs/logger.ts` | ç»“æ„åŒ– JSON æ—¥å¿— |
| Tracing | `sharedâ€‘libs/trace.ts` | TraceÂ ID ç”Ÿæˆä¸é€ä¼  |
| Auth | `sharedâ€‘libs/auth.ts` | JWT / HMAC è®¤è¯ |
| Task çŠ¶æ€ | `sharedâ€‘libs/task.ts` | DurableÂ Object çŠ¶æ€åŒ…è£… |
| Event | `sharedâ€‘libs/events/` | äº‹ä»¶ç±»å‹ä¸æ¥å£ |
| Utils | `sharedâ€‘libs/shared-utils/` | æ—¶é—´ã€IDã€é‡è¯•ç­‰é€šç”¨å‡½æ•° |
| TestÂ Mocks | `sharedâ€‘libs/test-utils.ts` | å•å…ƒ/é›†æˆæµ‹è¯•è¾…åŠ© |
| Schema | `sharedâ€‘libs/request-schema.ts` | APIÂ è¾“å…¥æ ¡éªŒ |
| Secrets | **CloudflareÂ SecretsÂ Store** | å…¨çƒå¯†é’¥åˆ†å‘ä¸æŒä¹…åŒ– |

---

## ğŸ“˜ å°ç»“  

ä¸Šè¿°æ¨¡å—åŒ–è®¾è®¡å¸¦æ¥ï¼š

* ğŸŒŸ **ä¸€è‡´æ€§**ï¼šæ—¥å¿—ã€è¿½è¸ªã€è®¤è¯ç­‰æ¨ªåˆ‡å…³æ³¨ç‚¹ä¸€å¤„ç»´æŠ¤  
* ğŸ§ª **å¯æµ‹è¯•æ€§**ï¼šå‰¯ä½œç”¨é›†ä¸­ã€æ˜“äº Mock  
* ğŸ”§ **ç±»å‹å®‰å…¨**ï¼šå…±äº«æ¥å£ & Schemaï¼Œå‡å°‘å¥‘çº¦æ¼‚ç§»  
* ğŸš€ **é•¿æœŸå¯ç»´æŠ¤**ï¼šæ–°å¢ Worker å¯å³æ’å³ç”¨å…±äº«åº“

è¿™ä¸€ç»“æ„ä¸º iN æ¶æ„çš„æ¼”è¿›ä¸å›¢é˜Ÿåä½œå¥ å®šäº†åšå®åŸºç¡€ã€‚
